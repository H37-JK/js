# 워크플로우의 이름 (GitHub Actions 탭에 표시됨)
name: 스크립트 실행

# 이 워크플로우를 언제 실행할지 결정하는 트리거
on:
  # 1. 스케줄에 따라 실행
  schedule:
    # cron 표현식: "분 시 일 월 요일" 순서. 아래는 매일 오전 3시(UTC 기준)에 실행
    # 한국 시간(KST)으로는 매일 정오(12시)에 해당합니다. (UTC+9)
    - cron: '*/1 * * * *'

  # 2. 수동으로 실행할 수 있도록 버튼 추가 (테스트용으로 매우 유용)
  workflow_dispatch:

# 실제 실행될 작업(Job)들의 목록
jobs:
  # 'run-script' 라는 이름의 작업 (이름은 자유롭게 지정 가능)
  run-script:
    # 이 작업을 실행할 가상 컴퓨터의 종류
    runs-on: ubuntu-latest

    # 작업 내에서 순서대로 실행될 단계(Step)들
    steps:
      # 1단계: 내 코드 가져오기
      # 가상 컴퓨터는 비어있으므로, 먼저 내 저장소의 코드를 내려받아야 함
      - name: Checkout my code
        uses: actions/checkout@v4

      # 2단계: Node.js 환경 설정
      # Puppeteer를 실행하려면 Node.js가 필요함
      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # 원하는 Node.js 버전

#      # 3단계: Puppeteer 실행에 필요한 시스템 라이브러리 설치 (가장 중요!!!)
#      # Puppeteer는 내부적으로 크롬 브라우저를 쓰기 때문에 관련 라이브러리가 필요함
#      - name: Install Puppeteer dependencies
#        run: |
#          sudo apt-get update
#          sudo apt-get install -yq gconf-service libasound2 libatk-bridge2.0-0 libatk1.0-0 libc6 libcairo2 libcups2 libdbus-1-3 libexpat1 libfontconfig1 libgbm1 libgcc1 libgconf-2-4 libgdk-pixbuf2.0-0 libglib2.0-0 libgtk-3-0 libnspr4 libpango-1.0-0 libpangocairo-1.0-0 libstdc++6 libx11-6 libx11-xcb1 libxcb1 libxcomposite1 libxcursor1 libxdamage1 libxext6 libxfixes3 libxi6 libxrandr2 libxrender1 libxss1 libxtst6 ca-certificates fonts-liberation libappindicator1 libnss3 lsb-release xdg-utils wget

      # 4단계: npm 패키지 설치
      # package.json에 명시된 puppeteer 등을 설치
      - name: Install NPM packages
        run: npm install

      # 5단계: 내 자바스크립트 파일 실행
      - name: Run my script
        run: node on.js
#
#      # (선택) 6단계: 결과물 업로드
#      # 스크립트 실행으로 생성된 파일(예: 스크린샷)을 확인하고 싶을 때 사용
#      - name: Upload artifacts
#        uses: actions/upload-artifact@v4
#        with:
#          name: naver-screenshot
#          path: naver_screenshot.png